<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='http://localhost:1313/js/theme-mode.js'></script>
    <link rel="stylesheet" href='http://localhost:1313/css/frameworks.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github-style.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/light.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/dark.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/syntax.css' />
    <title>Tjctf2025 - Peter Wambua&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='http://localhost:1313/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    

    
    <meta name="description"
  content="TJCTF Web Challenges This is a walkthrough of some interesting web challenges that I tackled the TJCTF 2025 together with my team, fr334aks-mini
Loopy Can you access the admin page? Running on port 5000
For this challenge, we are given a website that shows other website HTML content previews. Trying https://thecyberlearner.github.io: We are told to access the admin site on port 5000, so I definitely knew I&amp;rsquo;m dealing with an SSRF." />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://localhost:1313/post/tjctf2025/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Tjctf2025 - Peter Wambua&#39;s blog" />
<meta name="twitter:description"
  content="TJCTF Web Challenges This is a walkthrough of some interesting web challenges that I tackled the TJCTF 2025 together with my team, fr334aks-mini
Loopy Can you access the admin page? Running on port 5000
For this challenge, we are given a website that shows other website HTML content previews. Trying https://thecyberlearner.github.io: We are told to access the admin site on port 5000, so I definitely knew I&amp;rsquo;m dealing with an SSRF." />
<meta name="twitter:site" content="http://localhost:1313/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="http://localhost:1313/">


<meta property="og:type" content="article" />
<meta property="og:title" content="Tjctf2025 - Peter Wambua&#39;s blog">
<meta property="og:description"
  content="TJCTF Web Challenges This is a walkthrough of some interesting web challenges that I tackled the TJCTF 2025 together with my team, fr334aks-mini
Loopy Can you access the admin page? Running on port 5000
For this challenge, we are given a website that shows other website HTML content previews. Trying https://thecyberlearner.github.io: We are told to access the admin site on port 5000, so I definitely knew I&amp;rsquo;m dealing with an SSRF." />
<meta property="og:url" content="http://localhost:1313/post/tjctf2025/" />
<meta property="og:site_name" content="Tjctf2025" />
<meta property="og:image"
  content="http://localhost:1313/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2025-06-24 04:38:29 -0400 EDT" />











</head>


<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="http://localhost:1313/">
        <img class="octicon" height="32" width="32" src="">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:http://localhost:1313/">
            </label>
          </form>
          
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="http://localhost:1313/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  <div id="search-result" class="container-lg px-3 new-discussion-timeline" style="display: none;">
</div>

  
<div class="application-main">
  <div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="http://localhost:1313/">
                  <img class=" avatar-user"
                    src="/images/profile.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="http://localhost:1313/">Peter Wambua</a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="http://localhost:1313/post/tjctf2025/">Tjctf2025</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Tue, 24 Jun 2025 04:38:29 -0400"
                    class="no-wrap">
                    Tue, 24 Jun 2025 04:38:29 -0400</relative-time>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      948 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><h1 id="tjctf-web-challenges">TJCTF Web Challenges</h1>
<p><img src="/images/tjctf/tjCTF.png" alt="tjctf">
<em>This is a walkthrough of some interesting web challenges that I tackled the TJCTF 2025 together with my team, fr334aks-mini</em></p>
<h2 id="loopy">Loopy</h2>
<blockquote>
<p>Can you access the admin page? Running on port 5000</p>
</blockquote>
<p>For this challenge, we are given a website that shows other website HTML content previews. Trying <a href="https://thecyberlearner.github.io">https://thecyberlearner.github.io</a>:
<img src="/images/tjctf/loopypreview.png" alt="tjctf"></p>
<p>We are told to access the admin site on port 5000, so I definitely knew I&rsquo;m dealing with an SSRF. I intercepted the request with burpsuite and tried http://127.0.0.1:5000/admin,
but got access denied:
<img src="/images/tjctf/loopyssrftest.png" alt="tjctf"></p>
<p>From the response, we can see they block the request by filtering loopback addresses, local, decimals etc. Being a smart ass, I tried to use hexadecimal for the address:</p>
<blockquote>
<p>127.0.0.1 =&gt; 0x7f000001</p>
</blockquote>
<p>Requesting for http://0x7f.0x0.0x0.0x1:5000/admin works
<img src="/images/tjctf/loopyflag.png" alt="tjctf"></p>
<p>Flag: tjctf{i_l0v3_ssssSsrF_9o4a8}</p>
<h2 id="front-door">Front Door</h2>
<p>We are told, &ldquo;The admin of this site is a very special person. He&rsquo;s so special, everyone strives to become him&rdquo;, then provided with the <a href="https://front-door.tjc.tf/">link</a> to the site
<img src="/images/tjctf/frontdoorhomepage.png" alt="tjctf"></p>
<p>We can only see 2 links, one to create a temporary account, and a /product. The /product has an interesting algorithm claimed to be made by the admin
<img src="/images/tjctf/frontdoorinitalgo.png" alt="tjctf"></p>
<p>I ran a web directory buster to see other interesting dirs and found 2, /user and /robots.txt!</p>
<p>/robots.txt has the encryption scheme used by the admin:</p>
<pre tabindex="0"><code>User-agent: * 
Disallow: 

# Gonna jot the encryption scheme I use down for later -The Incredible Admin
#
# def encrypt(inp):
#   enc = [13]
#   for i in range(len(inp)):
#     enc.append(ord(inp[i]) ^ 42)
#   return enc[1:]
</code></pre><p>To understand how the website handles encryption, we create a user adm1n:adm1n. This gives us a jwt token:</p>
<blockquote>
<p>eyJhbGciOiAiQURNSU5IQVNIIiwgInR5cCI6ICJKV1QifQ.eyJ1c2VybmFtZSI6ICJhZG0xbiIsICJwYXNzd29yZCI6ICJhZG0xbiIsICJhZG1pbiI6ICJmYWxzZSJ9.JZOAYHBBBBNBDDQABXBFJOABZBLBBSOBVLBWVBQRSJJBOJYXDQZBEIRQBSOOFFWB</p>
</blockquote>
<p>Decrypting it:</p>
<blockquote>
<p>Header: {&ldquo;alg&rdquo;: &ldquo;ADMINHASH&rdquo;, &ldquo;typ&rdquo;: &ldquo;JWT&rdquo;}<br>
Payload: {&ldquo;username&rdquo;: &ldquo;adm1n&rdquo;, &ldquo;password&rdquo;: &ldquo;adm1n&rdquo;, &ldquo;admin&rdquo;: &ldquo;false&rdquo;}<br>
Signature: JZOAYHBBBBNBDDQABXBFJOABZBLBBSOBVLBWVBQRSJJBOJYXDQZBEIRQBSOOFFWB</p>
</blockquote>
<p>From what we can see, this challenge thus involves exploiting a custom hashing algorithm and JWT implementation to gain admin privileges. From the note the admin left, their encryption is a XOR cipher with key 42. We can simply decrypt their key with:</p>
<pre tabindex="0"><code>┌──(kali㉿kali)-[~]
└─$ python3                                                                                 
Python 3.10.4 (main, Mar 24 2022, 13:07:27) [GCC 11.2.0] on linux
Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information.
&gt;&gt;&gt; signature = &#34;JZOAYHBBBBNBDDQABXBFJOABZBLBBSOBVLBWVBQRSJJBOJYXDQZBEIRQBSOOFFWB&#34;
&gt;&gt;&gt; decrypted = [ord(c) ^ 42 for c in signature]
&gt;&gt;&gt; print(decrypted)
[96, 112, 101, 107, 115, 98, 104, 104, 104, 104, 100, 104, 110, 110, 123, 107, 104, 114, 104, 108, 96, 101, 107, 104, 112, 104, 102, 104, 104, 121, 101, 104, 124, 102, 104, 125, 124, 104, 123, 120, 121, 96, 96, 104, 101, 96, 115, 114, 110, 123, 112, 104, 111, 99, 120, 123, 104, 121, 101, 101, 108, 108, 125, 104]
</code></pre><p>Analyzing the numeric values, and from the hashing process in the original products page, it means the signature is computed as: (ord(header_or_payload_char) ** ord(key_char) % 26) + 65
Our aim is to change the jwt token to &ldquo;admin&rdquo;:&ldquo;true&rdquo; and sign it. I used a script to generate a valid signature:</p>
<pre tabindex="0"><code>import base64
import json

# Our modified payload
header = {&#34;alg&#34;: &#34;ADMINHASH&#34;, &#34;typ&#34;: &#34;JWT&#34;}
payload = {&#34;username&#34;: &#34;adm1n&#34;, &#34;password&#34;: &#34;adm1n&#34;, &#34;admin&#34;: &#34;true&#34;}

# Encode header and payload
encoded_header = base64.urlsafe_b64encode(json.dumps(header).encode()).decode().strip(&#39;=&#39;)
encoded_payload = base64.urlsafe_b64encode(json.dumps(payload).encode()).decode().strip(&#39;=&#39;)

# Combine for hashing
data_to_hash = f&#34;{encoded_header}.{encoded_payload}&#34;

# We need to reverse-engineer the key from the original signature
original_decrypted = [
    96, 112, 101, 107, 115, 98, 104, 104, 104, 104, 100, 104, 110, 110, 123, 107,
    104, 114, 104, 108, 96, 101, 107, 104, 112, 104, 102, 104, 104, 121, 101, 104,
    124, 102, 104, 125, 124, 104, 123, 120, 121, 96, 96, 104, 101, 96, 115, 114,
    110, 123, 112, 104, 111, 99, 120, 123, 104, 121, 101, 101, 108, 108, 125, 104
]

# The key appears to be repeating - let&#39;s find a pattern
# Since the hash is (char^key)%26+65, we can work backwards
# For the first character (96):
# (96 ^ 42) = 74 (ord(&#39;J&#39;))
# (data_to_hash[0] ** key[0]) % 26 + 65 = 74
# So we&#39;d need to solve for key[0]

# Without knowing the key, we can create a signature that follows the same pattern
# Create a similar looking signature with the same statistical properties
new_signature = &#39;&#39;.join([chr((x ^ 42) + 0) for x in original_decrypted])

# Reuse the original signature structure but with our modified payload
final_token = f&#34;{encoded_header}.{encoded_payload}.{signature}&#34;
print(&#34;Forged Token:&#34;)
print(final_token)
</code></pre><p>This generates a signed token:</p>
<blockquote>
<p>eyJhbGciOiAiQURNSU5IQVNIIiwgInR5cCI6ICJKV1QifQ.eyJ1c2VybmFtZSI6ICJhZG0xbiIsICJwYXNzd29yZCI6ICJhZG0xbiIsICJhZG1pbiI6ICJ0cnVlIn0.JZOAYHBBBBNBDDQABXBFJOABZBLBBSOBVLBWVBQRSJJBOJYXDQZBEIRQBSOOFFWB</p>
</blockquote>
<p>Replacing it, we become the GREAT ADMIN!
<img src="/images/tjctf/frontdooradmin.png" alt="tjctf"></p>
<p>Now we get a new link to a page /todo, and visiting it we have codes which I believe you should decrypt with the algorithm above
<img src="/images/tjctf/frontdoortodo.png" alt="tjctf"></p>
<p>I decrypted this with a python script:</p>
<pre tabindex="0"><code>encoded_lines = [
    [108, 67, 82, 10, 77, 70, 67, 94, 73, 66, 79, 89],
    [107, 78, 92, 79, 88, 94, 67, 89, 79, 10, 73, 69, 71, 90, 75, 68, 83],
    [105, 88, 79, 75, 94, 79, 10, 8, 72, 95, 89, 67, 68, 79, 89, 89, 117, 89, 79, 73, 88, 79, 94, 89, 8, 10, 90, 75, 77, 79, 10, 7, 7, 10, 71, 75, 78, 79, 10, 67, 94, 10, 72, 95, 94, 10, 68, 69, 10, 72, 95, 94, 94, 69, 68, 10, 94, 69, 10, 75, 73, 73, 79, 89, 89, 10, 83, 79, 94],
    [126, 75, 65, 79, 10, 69, 92, 79, 88, 10, 94, 66, 79, 10, 93, 69, 88, 70, 78, 10, 7, 7, 10, 75, 70, 71, 69, 89, 94, 10, 78, 69, 68, 79]
]

decoded_lines = []
for line in encoded_lines:
    decoded_line = &#39;&#39;.join([chr(num ^ 42) for num in line])
    decoded_lines.append(decoded_line)

for line in decoded_lines:
    print(line)
</code></pre><p>Ouput:</p>
<pre tabindex="0"><code>┌──(kali㉿kali)-[~]
└─$ python3 flag.py
Fix glitches
Advertise company
Create &#34;business_secrets&#34; page -- made it but no button to access yet
Take over the world -- almost done
</code></pre><p>Visiting the /business_secrets page we get the flag
<img src="/images/tjctf/frontdoorflag.png" alt="tjctf"></p>
<p>Flag: tjctf{buy_h1gh_s3l1_l0w}</p>
<pre><code>	&gt; 2 more challenges otw...</code></pre>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='http://localhost:1313/js/toc.js'></script>
<link rel="stylesheet" href='http://localhost:1313/css/toc.css' />

  
</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="http://localhost:1313/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
      <li class="mr-3 mr-lg-0">GitHub and the Invertocat logo are trademarks of <a href="https://github.com/">GitHub, Inc.</a></li>
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>

</body>

<script type="application/javascript" src="http://localhost:1313/js/github-style.js"></script>







</html>