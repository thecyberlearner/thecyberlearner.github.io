<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='http://localhost:1313/js/theme-mode.js'></script>
    <link rel="stylesheet" href='http://localhost:1313/css/frameworks.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github-style.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/light.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/dark.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/syntax.css' />
    <title>My First Pentest Report - Peter Wambua&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='http://localhost:1313/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="A writeup of the first Penetration Testing Report I wrote for my project in a penetration testing course" />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://localhost:1313/post/my-first-pentest-report/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="My First Pentest Report - Peter Wambua&#39;s blog" />
<meta name="twitter:description"
  content="A writeup of the first Penetration Testing Report I wrote for my project in a penetration testing course" />
<meta name="twitter:site" content="http://localhost:1313/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="http://localhost:1313/">


<meta property="og:type" content="article" />
<meta property="og:title" content="My First Pentest Report - Peter Wambua&#39;s blog">
<meta property="og:description"
  content="A writeup of the first Penetration Testing Report I wrote for my project in a penetration testing course" />
<meta property="og:url" content="http://localhost:1313/post/my-first-pentest-report/" />
<meta property="og:site_name" content="My First Pentest Report" />
<meta property="og:image"
  content="http://localhost:1313/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2023-03-06 01:29:45 -0400 -0400" />











</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="http://localhost:1313/">
        <img class="octicon" height="32" width="32" src="">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <img height="24" class="octicon octicon-three-bars" width="24" src="">
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:http://localhost:1313/">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="http://localhost:1313/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="http://localhost:1313/">
                  <img class=" avatar-user"
                    src="/images/profile.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="http://localhost:1313/"></a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="http://localhost:1313/post/my-first-pentest-report/">My First Pentest Report</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Mon, 06 Mar 2023 01:29:45 -0400"
                    class="no-wrap">
                    Mon, 06 Mar 2023 01:29:45 -0400</relative-time>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      1127 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><blockquote>
<p>For the last project of the penetration test course with <a href="https://x.com/PDaudt_InfoSec">Parker Daudt</a>, I needed to do a vulnerability assessment on OWASP JUICE SHOP and write a penetration testing report. I was able to find and exploit several vulnerabilities including SQL injection, XSS and Sensitive Data Exposure. I loved the experience and this is what I came up with:</p>
</blockquote>
<h1 id="capstoneiscollectiveorg-penetration-testing-report">capstone.iscollective.org Penetration Testing Report</h1>
<h2 id="confidentiality-statement">Confidentiality Statement</h2>
<p>This document is a confidential document owned by Wambua Penetration
Testing Company. It contains confidential information which is only to be
shared iscollective organization to disclose the security faults found in their
web application following a security assessment that was done.</p>
<h2 id="contact-information">Contact Information</h2>
<pre tabindex="0"><code>iscollective organization:
</code></pre><pre tabindex="0"><code>Name Position Contact Information
Parker Daudt Chief Information
Security Officer
</code></pre><pre tabindex="0"><code>parkerciso.iscollective@
gmail.com
+ 22 456 293 336
Peter Smith IT manager smithpeters.iscollective
@gmail.com
+ 67 352 292 442
</code></pre><pre tabindex="0"><code>Wambua Penetration Testing Company:
</code></pre><pre tabindex="0"><code>Name Position Contact Information
Peter Wambua Lead Pen Tester peterwambua@gmail.com
+ 254 714873030
James Masara Pen Tester masarajames@gmail.com
+ 254 742438721
</code></pre><h2 id="assessment-overview">Assessment Overview</h2>
<p>As from 2 nd March 2023 to 15 th March 2023 , iscollective involved Wambua
Penetration Testing Company in a penetration Test to assess the security of
their web application,https://capstone.iscollective.org/#/, find vulnerabilities,
report the vulnerabilities and then recommend necessary actions. Wambua
company carefully tested the website in accordance with the OWASP Top 10 to
ensure enough security was applied.</p>
<p>The following steps were carried out by the company:</p>
<ol>
<li>Planning - A plan was drawn which was how the assessment would take
place. Customer needs were gathered and rules of engagement taken.</li>
<li>Discovery - Scanning and enumeration were done to check out vulnerabilities
that may be present.</li>
<li>Engagement - The penetration testing team exploited any weak faults and
vulnerabilities they found on the website.</li>
<li>Report - A penetration report was written that highlights the vulnerabilities
existing on the website, and how to repair these.</li>
</ol>
<h2 id="in-scope">In-scope</h2>
<p><a href="https://capstone.iscollective.org/#/">https://capstone.iscollective.org/#/</a></p>
<p>All subdomains included</p>
<h2 id="out-of-scope">Out-of-scope</h2>
<p>None</p>
<h2 id="executive-summary">Executive Summary</h2>
<p>The purpose of this penetration test was to evaluate the security of the web
application hosted on the target system and identify any vulnerabilities that
could be exploited by an attacker. The testing was conducted over a period of
two weeks from March 2 , 2023 , to March 15 , 2023. The scope of the testing was
limited to the web application hosted on the target system.</p>
<p>The testing identified several high-risk and critical vulnerabilities that could lead
to unauthorized access to sensitive data, compromise the integrity of the
system, and impact the availability of the web application. We recommend that
the organization takes immediate action to address these vulnerabilities and
improve its overall security posture.</p>
<h2 id="testing-methodology">Testing Methodology</h2>
<p>The testing was done through a combination of various techniques, both
manual and automated. These included:</p>
<ol>
<li>Automated scanners - These were used to identify hidden directories.</li>
<li>Vulnerability scanners - Nessus scanner was used to identify vulnerabilities</li>
<li>Manual PenTesting - Most of the testing was done manually testing various
elements of the application</li>
</ol>
<p>The testing methodology was designed to simulate a real-world attack on the
web application, with a focus on the OWASP Top 10 vulnerabilities that can be
exploited by an attacker.</p>
<h2 id="findings">Findings</h2>
<p>The following vulnerabilities were found to be present:</p>
<p><em>Critical:</em></p>
<ol>
<li>SQL injection
The login page was found to be vulnerable to both Error based and blind
SQL injection.
With an interception of burp suite, credentialsadmin&rsquo; : adminwere
used. This throws an error exposing the SQL statement used to query
these credentials.
<img src="/images/pentest/report1.png" alt=""></li>
</ol>
<pre tabindex="0"><code>An SQL injection payload was crafted from this error message:
SELECT * FROM Users WHERE email = &#39;admin&#39; OR 1 = 1 ;--
So the credentialsadmin&#39; OR 1 = 1 ;:adminloginsin as an admin user.
</code></pre><ol start="2">
<li>Cross-Site Scripting</li>
</ol>
<pre tabindex="0"><code>The search feature on the home page was found to be vulnerable to
Reflected XSS.
The developers did a good job to sanitize ‘/’, so a payload like
&lt;script&gt;alert(XSS!)&lt;/script&gt; doesn’t work
</code></pre><pre tabindex="0"><code>Trying one without the /,
&lt;img src =q onerror=prompt( 8 )&gt; ,
&lt;iframe src=&#34;javascript:alert(`xss`)&#34;&gt;
These work fine.
</code></pre><p><img src="/images/pentest/report2.png" alt=""></p>
<p>XSS brings a huge issue to the website security as it may cause disclosure of the
user&rsquo;s session cookie allowing the attacker to hijack the user’s session and
completely take over the account.</p>
<ol start="3">
<li>Sensitive data exposure
i) Since we know the admin’s email,admin@juice-sh.op,we try the forgot
password feature. On entering the email, it displays the security question. This
is bad since through osint, you can easily find this information.
<img src="/images/pentest/report3.png" alt=""></li>
</ol>
<p>ii) After registering a user, the response showed information we did not
specify, a field,&ldquo;role&rdquo; : &ldquo;cutomer&rdquo;.
<img src="/images/pentest/report4.png" alt=""></p>
<p>This hinted to the security team how to register a user with admin privileges
Inserting&quot;role&quot; : &ldquo;admin&quot;in the request registereda privileged user.
<img src="/images/pentest/report5.png" alt=""></p>
<p><em>High risk:</em></p>
<ol>
<li>Broken authentication.
The application was found to have a weak password policy. With the
admin’s email, try some common passwords like admin, admin 123 ,
password, password 123 , 12345678 , qwertyuiop. The password admin 123
works! This is bad practice.</li>
</ol>
<pre tabindex="0"><code>The application was noted to allow password spraying. It did not block
multiple attempts of requests from the same client. This led to a
brute-forcing attack.
</code></pre><ol start="2">
<li>Session hijacking
The website was found to be vulnerable to session hijacking.
A user with the <a href="mailto:credentialswhoami@gmail.com">credentialswhoami@gmail.com</a> : whoamiwas created
Since we are logged as admin, grab the admin’s cookie.
<img src="/images/pentest/report6.png" alt=""></li>
</ol>
<pre tabindex="0"><code>The user whoami’s cookie was replaced with the admin&#39;s cookie. This led
to taking over of the admin’s account
</code></pre><p><img src="/images/pentest/report7.png" alt=""></p>
<h2 id="remediation">Remediation</h2>
<p>Based on the findings of the penetration test, we recommend the following
actions to improve the security posture of the web application:
i) Implement input validation to avoid trusting any direct input from users. This
will lead to the prevention of SQL injection.
ii) Implement output encoding before the output is returned to the user. Also,
validate all the input data, and make sure that only the allow-listed data is
allowed. These practices will mitigate cross-site scripting.
iii) Make sure to identify, filter, and classify client data. Encrypt or eliminate
sensitive data from APIs to avoid exposing it. Avoid storing no-essential data
and encrypting data at rest. These practices will mitigate sensitive data
exposure.
iv) Implement a strong password policy to prevent easy access to clients’
accounts.
Set a maximum number of requests that can be made by a client to the
application in a certain range of time. This will help stop brute-force attacks.
v) Implement secure session management to prevent session hijacking attacks.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The penetration test identified several critical and high-risk vulnerabilities in the
web application, which if left unaddressed, could lead to unauthorized access
to sensitive data and compromise the overall security of the organization. We
recommend that the organization takes immediate action to address these
vulnerabilities and implement the recommendations provided in this report.
Regular penetration testing and vulnerability assessments should be
conducted to maintain the security of the web application and ensure that it
remains protected against new and emerging threats.</p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='http://localhost:1313/js/toc.js'></script>
<link rel="stylesheet" href='http://localhost:1313/css/toc.css' />



  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="http://localhost:1313/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Contact me on <a href='https://www.linkedin.com/in/peter-wambua/'>LinkedIn</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="http://localhost:1313/js/github-style.js"></script>




</html>